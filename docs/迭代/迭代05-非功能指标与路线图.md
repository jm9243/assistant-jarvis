# 助手-贾维斯 PRD · 迭代05：非功能指标与路线图

> 覆盖第8章至文档结尾，包含非功能性需求、路线图、成功指标与附录。

## 8. 非功能性需求

### 8.1 性能要求

**PC端性能**
- **启动时间**: 应用冷启动时间 < 3秒
- **内存占用**: 空闲状态 < 200MB，执行任务时 < 500MB
- **CPU占用**: 空闲状态 < 5%，执行任务时 < 30%
- **响应时间**: UI操作响应 < 100ms
- **工作流执行**: 简单工作流 < 5秒，复杂工作流根据节点数量线性增长

**移动端性能**
- **启动时间**: 冷启动 < 2秒
- **内存占用**: < 100MB
- **流量消耗**: 正常使用 < 10MB/天
- **电量消耗**: 后台运行对电量影响 < 5%/小时

**云端性能**
- **API响应时间**: P95 < 200ms
- **并发支持**: 支持10000+并发用户
- **数据库查询**: 复杂查询 < 500ms
- **文件上传**: 支持100MB文件上传

### 8.2 可用性要求

**系统可用性**
- **目标可用性**: 99.9%（每月停机时间 < 43分钟）
- **故障恢复**: RTO < 1小时，RPO < 15分钟
- **数据备份**: 每日全量备份，实时增量备份
- **灾备方案**: 异地多活，自动故障转移

**用户体验**
- **离线可用**: PC端支持离线执行本地工作流
- **断线重连**: 网络断开后自动重连，恢复状态
- **错误提示**: 友好的错误提示和解决建议
- **操作引导**: 新用户引导、功能提示

### 8.3 安全性要求

**数据安全**
- **传输加密**: HTTPS、WSS加密传输
- **存储加密**: 敏感数据AES-256加密存储
- **密钥管理**: 系统密钥库存储（Keychain/Credential Manager）
- **数据脱敏**: 日志中敏感信息脱敏

**访问安全**
- **身份认证**: JWT Token，支持双因素认证
- **权限控制**: RBAC角色权限控制
- **API安全**: API密钥、签名验证、频率限制
- **审计日志**: 所有敏感操作记录审计日志

**隐私保护**
- **数据最小化**: 只收集必要的用户数据
- **用户授权**: 敏感权限需明确授权
- **数据删除**: 支持用户删除所有数据
- **隐私政策**: 明确的隐私政策和用户协议

### 8.4 兼容性要求

**PC端兼容性**
- **操作系统**: 
  - macOS 11.0+
  - Windows 10/11
- **屏幕分辨率**: 1280x720 及以上
- **浏览器**: Chrome 90+、Edge 90+、Firefox 88+、Safari 14+

**移动端兼容性**
- **iOS**: iOS 13.0+
- **Android**: Android 8.0+
- **屏幕尺寸**: 支持4.7寸至12.9寸屏幕

**浏览器兼容性（管理后台）**
- Chrome 90+
- Edge 90+
- Firefox 88+
- Safari 14+

### 8.5 可扩展性要求

**系统扩展**
- **水平扩展**: 支持服务器水平扩展
- **模块化设计**: 各功能模块独立，易于扩展
- **插件机制**: 支持第三方插件扩展
- **API开放**: 提供完整的API供第三方集成

**数据扩展**
- **数据库分片**: 支持数据库分片扩展
- **存储扩展**: 支持对象存储无限扩展
- **缓存扩展**: 支持Redis集群扩展

### 8.6 可维护性要求

**代码质量**
- **代码规范**: 统一的代码风格和规范
- **单元测试**: 核心功能单元测试覆盖率 > 80%
- **集成测试**: 关键流程集成测试覆盖
- **文档完善**: 完整的技术文档和API文档

**监控运维**
- **日志系统**: 完善的日志记录和查询
- **监控告警**: 实时监控和告警通知
- **性能分析**: 性能瓶颈分析工具
- **故障排查**: 快速定位和解决问题的工具

### 8.7 国际化要求

**语言支持**
- **初期**: 简体中文
- **后期**: 英文、繁体中文、日文、韩文

**本地化**
- **时区**: 自动识别用户时区
- **货币**: 支持多种货币显示
- **日期格式**: 根据地区显示日期格式

---

## 9. 产品路线图

### 9.1 MVP版本（V1.0）- 3个月

**核心功能**
- ✅ 用户认证和账号管理
- ✅ 工作流设计器（基础节点）
- ✅ 智能录制器
- ✅ 工作流执行引擎
- ✅ Basic Agent
- ✅ 简单的知识库管理
- ✅ PC端基础UI
- ✅ 云端基础服务（用户、工作流存储）

**目标**
- 验证核心价值：工作流自动化能力
- 获取早期用户反馈
- 打磨基础功能体验

### 9.2 增强版本（V1.5）- 2个月

**新增功能**
- ✅ ReAct Agent
- ✅ Agent工具调用
- ✅ 工作流高级节点（HTTP、MCP、AI Process）
- ✅ 工作流触发器（通知触发）
- ✅ 移动端基础版（监控、通知）
- ✅ 管理后台基础版（用户管理、数据管理）

**目标**
- 增强AI能力
- 支持移动端监控
- 支持基础的管理功能

### 9.3 专业版本（V2.0）- 3个月

**新增功能**
- ✅ Deep Research Agent
- ✅ Multi-Agent协同（工作流编排、组织架构）
- ✅ AI智能接听（语音通话）
- ✅ 完整的知识库和记忆系统
- ✅ 工具商店和治理
- ✅ 移动端完整版
- ✅ 管理后台完整版（模板市场、付费管理）

**目标**
- 完整的Multi-Agent能力
- 自动化通信助理
- 商业化准备

### 9.4 高阶智能版本（V3.0）- 3个月

**新增功能**
- ✅ Supervisor + Sub Agent协同
- ✅ Multi-Agent会议
- ✅ 企业级权限管理
- ✅ 团队协作功能
- ✅ 私有化部署支持
- ✅ 高级数据分析
- ✅ API开放平台

**目标**
- 满足企业级需求
- 支持私有化部署
- 构建开放生态

### 9.5 未来规划（V4.0+）

**可能的方向**
- 🔮 数字人视频通话
- 🔮 更多AI模型支持
- 🔮 跨应用智能协同
- 🔮 行业解决方案
- 🔮 AI训练和微调平台
- 🔮 更多第三方集成

#### 9.5.1 数字人视频通话技术方案（规划中）

这是AI通话功能的视觉增强版本，在语音对话的基础上增加数字人视频画面，实现更自然的视频通话体验。

**核心技术实现**：

1. **虚拟摄像头驱动安装**：
   - 使用`pyvirtualcam`库提供的安装脚本
   - 为操作系统注册一个虚拟摄像头驱动
   - 需要用户授权安装（类似虚拟音频驱动）
   - 安装后系统摄像头列表中会出现"助手-贾维斯"虚拟摄像头

2. **数字人引擎集成**：
   - **本地方案**：
     - 集成轻量级数字人生成模型（如Wav2Lip、SadTalker）
     - 使用预训练的数字人模型
     - 根据TTS音频实时生成口型同步的视频帧
     - 优点：隐私保护，无需网络
     - 缺点：对硬件要求较高，效果受限
   
   - **云端方案**：
     - 对接专业数字人服务（如腾讯智影、阿里云数字人）
     - 发送TTS音频或文本到云端
     - 接收实时生成的数字人视频流
     - 优点：效果更好，硬件要求低
     - 缺点：需要网络，有延迟

3. **视频帧生成与推流**：
   ```
   AI Agent生成回复文本
          ↓
   阿里云TTS（生成音频）
          ↓
   数字人引擎（音频 + 数字人模型）
          ↓
   生成视频帧（NumPy数组，通常30fps）
          ↓
   Python引擎使用pyvirtualcam推流
          ↓
   虚拟摄像头设备
          ↓
   视频通话应用（微信、Zoom、Teams等）选择"助手-贾维斯"摄像头
          ↓
   对方看到数字人画面
   ```

4. **技术实现细节**：
   ```python
   import pyvirtualcam
   import numpy as np
   
   # 创建虚拟摄像头
   with pyvirtualcam.Camera(width=1280, height=720, fps=30) as cam:
       print(f'虚拟摄像头: {cam.device}')
       
       while True:
           # 从数字人引擎获取视频帧（NumPy数组）
           frame = digital_human_engine.generate_frame(audio_chunk)
           
           # 推流到虚拟摄像头
           cam.send(frame)
           
           # 等待下一帧
           cam.sleep_until_next_frame()
   ```

5. **数字人形象定制**：
   - 用户可上传自己的照片训练个性化数字人
   - 提供多种预设数字人形象（男性、女性、不同年龄段）
   - 支持调整数字人的表情、动作、背景
   - 可配置数字人的服装、发型等外观

6. **性能优化**：
   - **帧缓冲**：预生成若干帧视频，减少实时生成压力
   - **分辨率自适应**：根据网络状况动态调整分辨率（720p/480p/360p）
   - **GPU加速**：使用CUDA/Metal加速视频帧生成
   - **关键帧策略**：静止画面时降低帧率，说话时提高帧率

7. **与视频通话应用集成**：
   - 用户在视频通话软件（微信、Zoom、Teams等）中
   - 打开摄像头设置，选择"助手-贾维斯"虚拟摄像头
   - 开始视频通话，对方看到的是数字人画面
   - 同时配合虚拟音频，实现完整的AI视频通话

8. **应用场景**：
   - **商务会议**：用户不方便露面时，用数字人代替参会
   - **客服视频**：企业客服使用统一的数字人形象
   - **教育培训**：数字人讲师进行在线授课
   - **直播带货**：7×24小时数字人直播

9. **技术挑战与解决方案**：
   - **延迟问题**：
     - 目标：端到端延迟 < 500ms
     - 方案：本地缓存、预生成、模型优化
   - **口型同步**：
     - 目标：音频与口型完全同步
     - 方案：使用Wav2Lip等专业口型同步模型
   - **自然度**：
     - 目标：数字人表情自然，不僵硬
     - 方案：使用高质量预训练模型，增加微表情
   - **资源占用**：
     - 目标：CPU < 50%，GPU < 70%，内存 < 2GB
     - 方案：模型量化、分辨率自适应、帧率动态调整

10. **隐私与安全**：
    - 用户照片仅用于训练个人数字人，不上传云端（本地方案）
    - 云端方案需明确告知用户数据使用方式
    - 提供数字人形象删除功能
    - 视频通话记录可选择是否保存

---

## 10. 成功指标

### 10.1 用户指标

**用户增长**
- **目标**: 
  - MVP版本：1000+注册用户
  - V1.5版本：5000+注册用户
  - V2.0版本：20000+注册用户
  - V3.0版本：50000+注册用户

**用户活跃**
- **DAU/MAU比例**: > 30%
- **7日留存率**: > 40%
- **30日留存率**: > 25%

**用户满意度**
- **NPS（净推荐值）**: > 50
- **应用评分**: > 4.5/5.0
- **用户反馈响应率**: > 90%

### 10.2 业务指标

**功能使用**
- **工作流创建率**: > 80%的用户创建至少1个工作流
- **工作流执行成功率**: > 95%
- **Agent使用率**: > 60%的用户使用Agent功能
- **AI通话使用率**: > 30%的用户使用AI接听功能

**商业化指标**
- **付费转化率**: > 10%
- **ARPU（每用户平均收入）**: > ¥50/月
- **模板市场GMV**: 
  - V2.0版本：¥10万/月
  - V3.0版本：¥50万/月
- **企业客户数**: 
  - V2.0版本：10+
  - V3.0版本：50+

### 10.3 技术指标

**性能指标**
- **API响应时间**: P95 < 200ms
- **工作流执行成功率**: > 95%
- **系统可用性**: > 99.9%
- **错误率**: < 0.1%

**质量指标**
- **Bug修复时间**: 
  - 严重Bug：< 24小时
  - 一般Bug：< 7天
- **用户反馈响应时间**: < 24小时
- **功能发布周期**: 每2周一个迭代

---

## 附录

### 附录A：术语表

| 术语 | 说明 |
|------|------|
| RPA | 机器人流程自动化（Robotic Process Automation） |
| Agent | 智能代理，能够自主决策和执行任务的AI实体 |
| Multi-Agent | 多智能体系统，多个Agent协同工作 |
| ReAct | Reasoning and Acting，推理和行动循环 |
| RAG | 检索增强生成（Retrieval-Augmented Generation） |
| MCP | Model Context Protocol，模型上下文协议 |
| AXUI | Accessibility UI，无障碍用户界面 |
| OCR | 光学字符识别（Optical Character Recognition） |
| ASR | 自动语音识别（Automatic Speech Recognition） |
| TTS | 文本转语音（Text-to-Speech） |
| LLM | 大语言模型（Large Language Model） |
| Token | 模型处理的基本单位 |
| Embedding | 向量嵌入 |
| WebSocket | 全双工通信协议 |
| JWT | JSON Web Token，用于身份认证 |
| RBAC | 基于角色的访问控制 |

### 附录B：参考文档

- **原有功能清单**: `docs/原有功能清单.md`
- **产品需求文档（草稿）**: `desktop/docs/drafts/产品需求文档.md`
- **技术架构文档（草稿）**: `desktop/docs/drafts/技术架构文档.md`

### 附录D：核心设计思想对照表

本表用于验证完整版PRD是否完整体现了原始设计文档中的核心思想和技术架构。

| 核心设计思想 | 原始文档描述 | 完整版PRD体现 | 状态 |
|------------|------------|-------------|------|
| **驾驶舱与引擎分离** | 前端Tauri 2 + React负责UI，后端Python Sidecar负责执行 | ✅ 第1.1节详细说明，第7.1节架构图展示 | ✅ 已完整体现 |
| **AgentScope作为AI核心** | 区别于LangChain，专为Multi-Agent设计 | ✅ 第7.1节明确说明选型理由 | ✅ 已完整体现 |
| **Tauri Sidecar模式** | 使用Tauri管理Python Sidecar生命周期 | ✅ 第7.1节架构图和说明 | ✅ 已完整体现 |
| **智能录制器叠加窗口** | 透明全屏窗口+鼠标穿透+实时高亮 | ✅ 第4.3.2节详细技术实现 | ✅ 已完整体现 |
| **元素稳定定位** | 保存内在属性而非坐标 | ✅ 第4.3.3节和第4.2.4节 | ✅ 已完整体现 |
| **Playwright持久化上下文** | 保持浏览器登录状态 | ✅ 第4.3.4节和第7.1节 | ✅ 已完整体现 |
| **虚拟音频设备** | VB-CABLE/BlackHole实现音频接管 | ✅ 第4.7.1节详细技术实现 | ✅ 已完整体现 |
| **音频重定向闭环** | 扬声器→虚拟输入→AI→虚拟输出→麦克风 | ✅ 第4.7.1节完整流程图和说明 | ✅ 已完整体现 |
| **虚拟摄像头** | pyvirtualcam推流数字人视频 | ✅ 第9.5.1节详细技术方案 | ✅ 已完整体现 |
| **数字人视频通话** | 实时生成视频帧并推流 | ✅ 第9.5.1节完整实现方案 | ✅ 已完整体现 |
| **pywinauto/pyobjc** | 操作系统原生API进行GUI自动化 | ✅ 第7.1节能力层说明 | ✅ 已完整体现 |
| **pynput事件监听** | 全局键鼠事件捕获 | ✅ 第4.3.2节和第7.1节 | ✅ 已完整体现 |
| **OCR降级容错** | Tesseract作为备选方案 | ✅ 第4.2.4节和第7.1节 | ✅ 已完整体现 |
| **通知监听触发** | 监听系统通知自动接听 | ✅ 第4.7.1节和第4.10.5节 | ✅ 已完整体现 |
| **PyInstaller打包** | Python环境打包为独立可执行文件 | ✅ 第7.1节架构说明 | ✅ 已完整体现 |

**验证结论**：

✅ **所有核心设计思想已完整体现在完整版PRD中**

本次更新成功将原始设计文档（产品需求文档草稿和技术架构文档草稿）中的核心理念、技术架构和实现细节完整融入到了产品需求文档完整版中，主要更新包括：

1. **产品愿景**：补充了"驾驶舱与引擎分离"的核心设计哲学
2. **技术架构**：详细展示了PC端核心架构，明确了Sidecar模式和各层职责
3. **智能录制器**：补充了叠加窗口、元素高亮、鼠标穿透的完整技术实现
4. **AI通话**：详细说明了虚拟音频设备、音频重定向闭环的完整流程
5. **数字人视频通话**：补充了虚拟摄像头、视频帧推流的完整技术方案

文档现在完整反映了项目的技术架构设计思想，可以作为开发团队的指导文档。

### 附录C：变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| V1.0 | 2025-11-08 | 初始草稿版本 | - |
| V2.0 | 2025-11-08 | 完整版PRD，整合三端功能 | - |
| V2.1 | 2025-11-08 | 基于原始设计文档的重大更新：<br>1. 补充"驾驶舱与引擎分离"核心设计哲学<br>2. 详细展示PC端核心架构（Tauri + Python Sidecar）<br>3. 补充智能录制器技术实现（叠加窗口、元素高亮）<br>4. 补充AI通话技术实现（虚拟音频、音频重定向）<br>5. 补充数字人视频通话技术方案（虚拟摄像头）<br>6. 明确AgentScope作为Multi-Agent核心框架<br>7. 添加核心设计思想对照表验证完整性 | AI Assistant |
| V2.2 | 2025-11-08 | 更新云端服务技术架构：<br>1. 明确使用Go + Supabase实现云端服务<br>2. 详细说明Supabase核心能力（数据库、认证、存储、实时订阅）<br>3. 说明Go后端服务职责和技术优势<br>4. 强调所有用户数据统一存储在Supabase项目中 | AI Assistant |

---

## 文档结尾

**文档状态**: ✅ 已完成（V2.2）  
**最后更新**: 2025-11-08  
**文档维护**: 产品团队

**说明**: 
本文档（V2.2版本）是基于原始设计文档（产品需求文档草稿和技术架构文档草稿）进行的重大更新，完整整合了核心设计理念和技术架构细节。文档涵盖了PC端、移动端和管理后台三端的详细功能需求，以及完整的技术架构、实现细节、非功能性需求、产品路线图和成功指标。

**核心更新亮点**：
- ✅ 明确"驾驶舱与引擎分离"的核心架构设计
- ✅ 详细的智能录制器技术实现（叠加窗口、元素高亮机制）
- ✅ 完整的AI通话技术方案（虚拟音频、音频重定向闭环）
- ✅ 数字人视频通话技术方案（虚拟摄像头、视频帧推流）
- ✅ AgentScope作为Multi-Agent核心框架的明确定位
- ✅ 云端服务采用Go + Supabase技术栈，统一管理所有用户数据
- ✅ 所有核心设计思想已通过对照表验证完整性

**下一步行动**:
1. 技术团队评审技术架构可行性（重点关注Sidecar模式和虚拟设备集成）
2. UI/UX团队设计交互原型（重点关注叠加窗口和录制体验）
3. 产品团队细化优先级和迭代计划
4. 开发团队制定详细的技术实现方案（参考第7章技术架构）
5. 进行虚拟音频/摄像头驱动的兼容性测试
6. 搭建Supabase项目并设计数据库Schema
